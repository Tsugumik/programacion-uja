@startuml
' Diagram settings
skinparam classAttributeIconSize 0
skinparam monochrome true
skinparam linetype ortho
hide empty members

title Smart Home System

' --- Base and Core Classes ---

abstract class Device {
  - _id: str
  - _status: bool
  - _intensity: int
  - _min_intensity: int
  - _max_intensity: int
  + <<property>> id: str
  + <<property>> status: bool
  + <<property>> intensity: int
  + turn_on()
  + turn_off()
  + increase_intensity(amount: int)
  + decrease_intensity(amount: int)
  + to_dict(): dict
}

class Home {
  - _name: str
  - _rooms: list
  - _devices: dict
  - _schedulers: dict
  + <<property>> name: str
  + <<property>> rooms: list
  + <<property>> devices: dict
  + add_room(room_name: str)
  + add_device_to_room(device: Device, room: str)
  + remove_device(device_id: str)
  + get_device_by_id(device_id: str): Device
  + get_scheduler_for_device(device_id: str): Scheduler
  + get_devices_in_room(room_name: str): list
  + to_dict(): dict
  + {static} from_dict(data: dict): Home
}

class Scheduler {
  - _smart_bulb: SmartBulb
  - _schedule: list
  + <<property>> smart_bulb: SmartBulb
  + <<property>> schedule: list
  + {static} get_week_days(): list
  + {static} get_system_time(): str
  - {static} _validate_event_time(day: str, h: int, m: int, s: int)
  + add_event(day: str, h: int, m: int, s: int, action: str)
  + delete_event(event_index: int)
  + to_dict(): dict
  + {static} from_dict(data: dict, smart_bulb: SmartBulb): Scheduler
}

' --- Device Subclasses ---

class SmartBulb extends Device {
  - {static} _id_counter: count
  - _name: str
  - _is_programmable: bool
  - _color: dict
  + <<property>> name: str
  + <<property>> is_programmable: bool
  + <<property>> color: dict
  + change_color(r: int, g: int, b: int)
  + to_dict(): dict
  + {static} from_dict(data: dict): SmartBulb
}

class AirConditioner extends Device {
  - {static} _id_counter: count
  - _name: str
  + <<property>> name: str
  + <<property>> temperature: int
  + to_dict(): dict
  + {static} from_dict(data: dict): AirConditioner
}

' --- Persistence Module ---

class Persistence <<Module>> {
  + {static} save_home_to_json(home: Home, filename: str)
  + {static} load_home_from_json(filename: str): Home
}

' --- Relationships ---

Home o-- "devices" Device : contains
Home o-- "schedulers" Scheduler : manages

Scheduler ..> SmartBulb : schedules for

Persistence ..> Home : serializes/deserializes
Persistence ..> SmartBulb : creates
Persistence ..> AirConditioner : creates
Persistence ..> Scheduler : creates

@enduml
